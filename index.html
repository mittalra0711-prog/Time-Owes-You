<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<title>Time Owes You</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;touch-action:none}
body{background:#0e0e0e;color:white;font-family:Arial;overflow:hidden}
canvas{display:block}

button{
background:#333;color:white;border:none;
border-radius:10px;padding:12px 18px;
font-size:16px;
}

.screen{
position:fixed;inset:0;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
gap:14px;background:#0e0e0e;
z-index:10;
}

#ui{
position:fixed;top:10px;left:50%;
transform:translateX(-50%);
text-align:center;z-index:5;display:none;
}

#controls,#touchPad,#boost{
position:fixed;z-index:5;display:none;
}

#controls{bottom:20px;left:20px}
#controls button{width:60px;height:60px;font-size:24px}

#touchPad{
bottom:30px;left:30px;
width:120px;height:120px;
border-radius:50%;
background:rgba(255,255,255,0.08);
}

#boost{
bottom:20px;right:20px;
width:80px;height:80px;border-radius:50%;
background:orange;color:black;font-weight:bold;
}
</style>
</head>

<body>

<div id="menu" class="screen">
<h1>TIME OWES YOU</h1>
<button onclick="startGame()">PLAY</button>
<button onclick="openOptions()">OPTIONS</button>
</div>

<div id="options" class="screen" style="display:none">
<h2>CONTROLS</h2>
<button onclick="setControl('buttons')">Arrow Buttons</button>
<button onclick="setControl('touch')">Touch Pad</button>
<button onclick="closeOptions()">BACK</button>
</div>

<div id="gameOver" class="screen" style="display:none">
<h2>GAME OVER</h2>
<div id="finalStats"></div>
<button onclick="restart()">RESTART</button>
<button onclick="backToMenu()">MENU</button>
</div>

<div id="ui">
<div>TIME: <span id="time">30</span></div>
<div>MISSION: <span id="mission">Collect Orbs</span></div>
</div>

<canvas id="game"></canvas>

<div id="controls">
<button id="up">↑</button><br>
<button id="left">←</button>
<button id="down">↓</button>
<button id="right">→</button>
</div>

<div id="touchPad"></div>
<button id="boost">BOOST</button>

<script>
window.onload=()=>{

/* ===== SETUP ===== */
const c=document.getElementById("game"),ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
resize();addEventListener("resize",resize);

/* ===== STATE ===== */
let control=localStorage.getItem("control")||"buttons";
let running=false,time=30,last=Date.now(),orbs=0;
let boost=false,boostT=0;

const player={x:c.width/2,y:c.height/2,r:16,s:4};
const enemy={x:100,y:100,r:14,s:2};
const orb={x:200,y:200,r:10};

/* ===== UI ===== */
const ui=timeUI=document.getElementById("ui");
const timeSpan=document.getElementById("time");
const missionSpan=document.getElementById("mission");

/* ===== CONTROLS ===== */
let up=false,down=false,left=false,right=false;

function bindBtn(id,set){
const b=document.getElementById(id);
b.ontouchstart=e=>{e.preventDefault();set(true)};
b.ontouchend=e=>{e.preventDefault();set(false)};
}
bindBtn("up",v=>up=v);
bindBtn("down",v=>down=v);
bindBtn("left",v=>left=v);
bindBtn("right",v=>right=v);

/* Touch Pad */
const pad=document.getElementById("touchPad");
pad.ontouchmove=e=>{
const t=e.touches[0];
const r=pad.getBoundingClientRect();
const dx=t.clientX-(r.left+r.width/2);
const dy=t.clientY-(r.top+r.height/2);
up=dy<-20;down=dy>20;left=dx<-20;right=dx>20;
};
pad.ontouchend=()=>up=down=left=right=false;

/* Boost */
boostBtn=document.getElementById("boost");
boostBtn.ontouchstart=e=>{
e.preventDefault();
if(!boost){boost=true;boostT=5;}
};

/* ===== GAME FLOW ===== */
function startGame(){
menu.style.display="none";
ui.style.display="block";
boostBtn.style.display="block";
(control==="buttons"?controls:touchPad).style.display="block";

time=30;orbs=0;boost=false;
player.x=c.width/2;player.y=c.height/2;
spawnOrb();running=true;last=Date.now();loop();
}

function endGame(){
running=false;
ui.style.display="none";
controls.style.display="none";
touchPad.style.display="none";
boostBtn.style.display="none";
finalStats.innerHTML=`Orbs Collected: ${orbs}`;
gameOver.style.display="flex";
}

function loop(){
if(!running)return;
requestAnimationFrame(loop);

const now=Date.now();
if(now-last>=1000){
time--;last=now;
timeSpan.textContent=time;
if(boost){boostT--;if(boostT<=0)boost=false;}
if(time<=0){endGame();return;}
}

const sp=player.s*(boost?2:1);
if(up)player.y-=sp;if(down)player.y+=sp;
if(left)player.x-=sp;if(right)player.x+=sp;

enemy.x+=Math.sign(player.x-enemy.x)*enemy.s;
enemy.y+=Math.sign(player.y-enemy.y)*enemy.s;

if(dist(player,orb)<26){
time+=10;orbs++;spawnOrb();
missionSpan.textContent=`Collect Orbs (${orbs})`;
}
if(dist(player,enemy)<30)time-=7;

draw();
}

function draw(){
ctx.clearRect(0,0,c.width,c.height);
drawC(player,boost?"orange":"cyan");
drawC(orb,"lime");
drawC(enemy,"red");
}
function drawC(o,col){
ctx.fillStyle=col;ctx.beginPath();
ctx.arc(o.x,o.y,o.r,0,7);ctx.fill();
}
function dist(a,b){return Math.hypot(a.x-b.x,a.y-b.y)}
function spawnOrb(){
orb.x=Math.random()*(c.width-40)+20;
orb.y=Math.random()*(c.height-40)+20;
}

/* ===== MENUS ===== */
window.openOptions=()=>{menu.style.display="none";options.style.display="flex"}
window.closeOptions=()=>{options.style.display="none";menu.style.display="flex"}
window.setControl=c=>{
control=c;localStorage.setItem("control",c);
alert("Control set to "+c);
}
window.restart=()=>{gameOver.style.display="none";startGame()}
window.backToMenu=()=>{gameOver.style.display="none";menu.style.display="flex"}

};
</script>

</body>
</html>
